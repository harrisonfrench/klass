{% extends "dashboard_base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="notion-dashboard">
    <!-- Header -->
    <div class="dashboard-header">
        <h1>Welcome back</h1>
        <a href="{{ url_for('classes.create_class') }}" class="btn btn-sm btn-primary">
            <span data-feather="plus"></span>
            New Class
        </a>
    </div>

    <!-- Recent Classes Section -->
    <div class="dashboard-section">
        <div class="section-header-minimal">
            <h2>Classes</h2>
            <a href="{{ url_for('classes.list_classes') }}">View all</a>
        </div>

        {% if classes %}
        <div class="class-grid">
            {% for class in classes %}
            <a href="{{ url_for('classes.view_class', class_id=class.id) }}" class="class-item">
                <div class="class-dot" style="background-color: {{ class.color }};"></div>
                <div class="class-info">
                    <span class="class-name">{{ class.name }}</span>
                    {% if class.code %}
                    <span class="class-code">{{ class.code }}</span>
                    {% endif %}
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state-minimal">
            <p>No classes yet. <a href="{{ url_for('classes.create_class') }}">Create your first class</a></p>
        </div>
        {% endif %}
    </div>

    <!-- Recent Notes Section -->
    <div class="dashboard-section">
        <div class="section-header-minimal">
            <h2>Recent Notes</h2>
            <a href="{{ url_for('notes.list_notes') }}">View all</a>
        </div>

        {% if recent_notes %}
        <div class="notes-list">
            {% for note in recent_notes %}
            <a href="{{ url_for('notes.view_note', note_id=note.id) }}" class="note-item">
                <div class="note-dot" style="background-color: {{ note.class_color }};"></div>
                <div class="note-content">
                    <span class="note-title">{{ note.title or 'Untitled' }}</span>
                    <span class="note-preview">{{ note.content|striptags|truncate(60) if note.content else 'Empty note' }}</span>
                </div>
                <span class="note-date">{{ (note.updated_at|string)[:10] if note.updated_at else '' }}</span>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state-minimal">
            <p>No notes yet. Create a class and start taking notes.</p>
        </div>
        {% endif %}
    </div>

    <!-- Quick Access -->
    <div class="dashboard-section">
        <div class="section-header-minimal">
            <h2>Quick Access</h2>
        </div>
        <div class="quick-links">
            <a href="{{ url_for('flashcards.list_decks') }}" class="quick-link">
                <span data-feather="layers"></span>
                Flashcards
            </a>
            <a href="{{ url_for('study_guides.list_guides') }}" class="quick-link">
                <span data-feather="book-open"></span>
                Study Guides
            </a>
            <a href="{{ url_for('quizzes.list_quizzes') }}" class="quick-link">
                <span data-feather="check-square"></span>
                Quizzes
            </a>
            <a href="javascript:void(0)" onclick="toggleAiChat()" class="quick-link">
                <span data-feather="message-circle"></span>
                AI Tutor
            </a>
        </div>
    </div>
</div>

<style>
.notion-dashboard {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1.5rem;
}

.dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
}

.dashboard-header h1 {
    font-size: 1.75rem;
    font-weight: 600;
    color: var(--text);
    margin: 0;
}

.dashboard-section {
    margin-bottom: 2.5rem;
}

.section-header-minimal {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.section-header-minimal h2 {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
    margin: 0;
}

.section-header-minimal a {
    font-size: 0.8rem;
    color: var(--primary);
    text-decoration: none;
}

.section-header-minimal a:hover {
    text-decoration: underline;
}

/* Class Grid */
.class-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 0.75rem;
}

.class-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    text-decoration: none;
    transition: background 0.15s, border-color 0.15s;
}

.class-item:hover {
    background: var(--bg-hover);
    border-color: var(--text-muted);
}

.class-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
}

.class-info {
    display: flex;
    flex-direction: column;
    min-width: 0;
}

.class-name {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.class-code {
    font-size: 0.75rem;
    color: var(--text-muted);
}

/* Notes List */
.notes-list {
    display: flex;
    flex-direction: column;
}

.note-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--border-light);
    text-decoration: none;
    transition: background 0.15s;
}

.note-item:hover {
    background: var(--bg-hover);
    margin: 0 -0.5rem;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    border-radius: 4px;
}

.note-item:last-child {
    border-bottom: none;
}

.note-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}

.note-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
}

.note-title {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.note-preview {
    font-size: 0.8rem;
    color: var(--text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.note-date {
    font-size: 0.75rem;
    color: var(--text-light);
    flex-shrink: 0;
}

/* Quick Links */
.quick-links {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.quick-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 6px;
    font-size: 0.85rem;
    color: var(--text);
    text-decoration: none;
    transition: background 0.15s, border-color 0.15s;
}

.quick-link:hover {
    background: var(--bg-hover);
    border-color: var(--text-muted);
}

.quick-link svg {
    width: 16px;
    height: 16px;
    color: var(--text-muted);
}

/* Empty States */
.empty-state-minimal {
    padding: 1.5rem;
    text-align: center;
    color: var(--text-muted);
    font-size: 0.9rem;
}

.empty-state-minimal a {
    color: var(--primary);
}
</style>
{% endblock %}

{% block scripts %}
<script>
    feather.replace();
</script>
{% endblock %}

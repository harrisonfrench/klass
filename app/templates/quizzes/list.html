{% extends "dashboard_base.html" %}

{% block title %}Quizzes{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Quizzes</h1>
    {% if classes %}
    <div class="dropdown">
        <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
            <span data-feather="plus"></span>
            Create Quiz
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
            {% for class in classes %}
            <li>
                <a class="dropdown-item" href="{{ url_for('quizzes.generate_quiz_page', class_id=class.id) }}">
                    <span class="class-dot me-2" style="background: {{ class.color }};"></span>
                    {{ class.name }}
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>

{% if quizzes %}
<div class="grid-auto">
    {% for quiz in quizzes %}
    <a href="{{ url_for('quizzes.view_quiz', quiz_id=quiz.id) }}" class="item-card" style="border-left: 3px solid {{ quiz.class_color }};">
        <div class="item-content">
            <div class="item-title">{{ quiz.title }}</div>
            <div class="item-subtitle">{{ quiz.class_code or quiz.class_name }}</div>
        </div>
        <div style="text-align: right;">
            <div class="item-meta">{{ quiz.attempt_count or 0 }} attempts</div>
            {% if quiz.best_score is not none and quiz.total_questions %}
            <div class="item-meta" style="color: var(--success);">Best: {{ quiz.best_score }}/{{ quiz.total_questions }}</div>
            {% endif %}
        </div>
    </a>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <span data-feather="check-circle"></span>
    <h5>No quizzes yet</h5>
    <p>Generate a quiz from your notes to test your knowledge.</p>
    {% if classes %}
    <div class="dropdown d-inline-block">
        <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
            <span data-feather="plus"></span>
            Create Your First Quiz
        </button>
        <ul class="dropdown-menu">
            {% for class in classes %}
            <li>
                <a class="dropdown-item" href="{{ url_for('quizzes.generate_quiz_page', class_id=class.id) }}">
                    <span class="class-dot me-2" style="background: {{ class.color }};"></span>
                    {{ class.name }}
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% else %}
    <p class="text-muted">Create a class and add some notes first.</p>
    {% endif %}
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
    feather.replace();
</script>
{% endblock %}
